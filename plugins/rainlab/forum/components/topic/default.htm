<div class="rainlab-forum">

    {% flash %}
        <div class="alert alert-{{ type == 'error' ? 'danger' : type }}">
            {{ message }}
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
        </div>
    {% endflash %}

    {% if returnUrl %}
        <p>&larr; <a href="{{ returnUrl }}">Back to {{ channel.title }}</a></p>
    {% endif %}

    {% if topic %}

        <h4>{{ topic.subject }}</h4>

        {% partial __SELF__ ~ "::controlpanel" %}

        {% partial __SELF__ ~ "::posts" %}

        {% partial __SELF__ ~ "::pagination" %}

        <h4>Reply to this discussion</h4>
        {% if member %}
            {% partial __SELF__ ~ "::postform" %}
        {% else %}
            <p>You should be logged in before you can post.</p>
        {% endif %}

    {% elseif channel %}

        <h4>Create a new discussion topic</h4>
        {% partial __SELF__ ~ "::createform" %}

    {% else %}

        <p>Topic not found</p>

    {% endif %}
</div>